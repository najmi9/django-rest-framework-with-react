{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\n\nvar entities_json_1 = __importDefault(require(\"entities/lib/maps/entities.json\"));\n\nvar legacy_json_1 = __importDefault(require(\"entities/lib/maps/legacy.json\"));\n\nvar xml_json_1 = __importDefault(require(\"entities/lib/maps/xml.json\"));\n\nfunction whitespace(c) {\n  return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\n\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n  var lower = upper.toLowerCase();\n\n  if (upper === lower) {\n    return function (t, c) {\n      if (c === lower) {\n        t._state = SUCCESS;\n      } else {\n        t._state = FAILURE;\n        t._index--;\n      }\n    };\n  } else {\n    return function (t, c) {\n      if (c === lower || c === upper) {\n        t._state = SUCCESS;\n      } else {\n        t._state = FAILURE;\n        t._index--;\n      }\n    };\n  }\n}\n\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n  var lower = upper.toLowerCase();\n  return function (t, c) {\n    if (c === lower || c === upper) {\n      t._state = NEXT_STATE;\n    } else {\n      t._state = 3\n      /* InTagName */\n      ;\n      t._index--; //consume the token again\n    }\n  };\n}\n\nvar stateBeforeCdata1 = ifElseState(\"C\", 23\n/* BeforeCdata2 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata2 = ifElseState(\"D\", 24\n/* BeforeCdata3 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata3 = ifElseState(\"A\", 25\n/* BeforeCdata4 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata4 = ifElseState(\"T\", 26\n/* BeforeCdata5 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata5 = ifElseState(\"A\", 27\n/* BeforeCdata6 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeScript1 = consumeSpecialNameChar(\"R\", 34\n/* BeforeScript2 */\n);\nvar stateBeforeScript2 = consumeSpecialNameChar(\"I\", 35\n/* BeforeScript3 */\n);\nvar stateBeforeScript3 = consumeSpecialNameChar(\"P\", 36\n/* BeforeScript4 */\n);\nvar stateBeforeScript4 = consumeSpecialNameChar(\"T\", 37\n/* BeforeScript5 */\n);\nvar stateAfterScript1 = ifElseState(\"R\", 39\n/* AfterScript2 */\n, 1\n/* Text */\n);\nvar stateAfterScript2 = ifElseState(\"I\", 40\n/* AfterScript3 */\n, 1\n/* Text */\n);\nvar stateAfterScript3 = ifElseState(\"P\", 41\n/* AfterScript4 */\n, 1\n/* Text */\n);\nvar stateAfterScript4 = ifElseState(\"T\", 42\n/* AfterScript5 */\n, 1\n/* Text */\n);\nvar stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", 44\n/* BeforeStyle2 */\n);\nvar stateBeforeStyle2 = consumeSpecialNameChar(\"L\", 45\n/* BeforeStyle3 */\n);\nvar stateBeforeStyle3 = consumeSpecialNameChar(\"E\", 46\n/* BeforeStyle4 */\n);\nvar stateAfterStyle1 = ifElseState(\"Y\", 48\n/* AfterStyle2 */\n, 1\n/* Text */\n);\nvar stateAfterStyle2 = ifElseState(\"L\", 49\n/* AfterStyle3 */\n, 1\n/* Text */\n);\nvar stateAfterStyle3 = ifElseState(\"E\", 50\n/* AfterStyle4 */\n, 1\n/* Text */\n);\nvar stateBeforeEntity = ifElseState(\"#\", 52\n/* BeforeNumericEntity */\n, 53\n/* InNamedEntity */\n);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 55\n/* InHexEntity */\n, 54\n/* InNumericEntity */\n);\n\nvar Tokenizer =\n/** @class */\nfunction () {\n  function Tokenizer(options, cbs) {\n    /** The current state the tokenizer is in. */\n    this._state = 1\n    /* Text */\n    ;\n    /** The read buffer. */\n\n    this._buffer = \"\";\n    /** The beginning of the section that is currently being read. */\n\n    this._sectionStart = 0;\n    /** The index within the buffer that we are currently looking at. */\n\n    this._index = 0;\n    /**\n     * Data that has already been processed will be removed from the buffer occasionally.\n     * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n     */\n\n    this._bufferOffset = 0;\n    /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n\n    this._baseState = 1\n    /* Text */\n    ;\n    /** For special parsing behavior inside of script and style tags. */\n\n    this._special = 1\n    /* None */\n    ;\n    /** Indicates whether the tokenizer has been paused. */\n\n    this._running = true;\n    /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n\n    this._ended = false;\n    this._cbs = cbs;\n    this._xmlMode = !!(options && options.xmlMode);\n    this._decodeEntities = !!(options && options.decodeEntities);\n  }\n\n  Tokenizer.prototype.reset = function () {\n    this._state = 1\n    /* Text */\n    ;\n    this._buffer = \"\";\n    this._sectionStart = 0;\n    this._index = 0;\n    this._bufferOffset = 0;\n    this._baseState = 1\n    /* Text */\n    ;\n    this._special = 1\n    /* None */\n    ;\n    this._running = true;\n    this._ended = false;\n  };\n\n  Tokenizer.prototype._stateText = function (c) {\n    if (c === \"<\") {\n      if (this._index > this._sectionStart) {\n        this._cbs.ontext(this._getSection());\n      }\n\n      this._state = 2\n      /* BeforeTagName */\n      ;\n      this._sectionStart = this._index;\n    } else if (this._decodeEntities && this._special === 1\n    /* None */\n    && c === \"&\") {\n      if (this._index > this._sectionStart) {\n        this._cbs.ontext(this._getSection());\n      }\n\n      this._baseState = 1\n      /* Text */\n      ;\n      this._state = 51\n      /* BeforeEntity */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateBeforeTagName = function (c) {\n    if (c === \"/\") {\n      this._state = 5\n      /* BeforeClosingTagName */\n      ;\n    } else if (c === \"<\") {\n      this._cbs.ontext(this._getSection());\n\n      this._sectionStart = this._index;\n    } else if (c === \">\" || this._special !== 1\n    /* None */\n    || whitespace(c)) {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (c === \"!\") {\n      this._state = 15\n      /* BeforeDeclaration */\n      ;\n      this._sectionStart = this._index + 1;\n    } else if (c === \"?\") {\n      this._state = 17\n      /* InProcessingInstruction */\n      ;\n      this._sectionStart = this._index + 1;\n    } else {\n      this._state = !this._xmlMode && (c === \"s\" || c === \"S\") ? 31\n      /* BeforeSpecial */\n      : 3\n      /* InTagName */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateInTagName = function (c) {\n    if (c === \"/\" || c === \">\" || whitespace(c)) {\n      this._emitToken(\"onopentagname\");\n\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._stateBeforeClosingTagName = function (c) {\n    if (whitespace(c)) {// ignore\n    } else if (c === \">\") {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (this._special !== 1\n    /* None */\n    ) {\n        if (c === \"s\" || c === \"S\") {\n          this._state = 32\n          /* BeforeSpecialEnd */\n          ;\n        } else {\n          this._state = 1\n          /* Text */\n          ;\n          this._index--;\n        }\n      } else {\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateInClosingTagName = function (c) {\n    if (c === \">\" || whitespace(c)) {\n      this._emitToken(\"onclosetag\");\n\n      this._state = 7\n      /* AfterClosingTagName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._stateAfterClosingTagName = function (c) {\n    //skip everything until \">\"\n    if (c === \">\") {\n      this._state = 1\n      /* Text */\n      ;\n      this._sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype._stateBeforeAttributeName = function (c) {\n    if (c === \">\") {\n      this._cbs.onopentagend();\n\n      this._state = 1\n      /* Text */\n      ;\n      this._sectionStart = this._index + 1;\n    } else if (c === \"/\") {\n      this._state = 4\n      /* InSelfClosingTag */\n      ;\n    } else if (!whitespace(c)) {\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateInSelfClosingTag = function (c) {\n    if (c === \">\") {\n      this._cbs.onselfclosingtag();\n\n      this._state = 1\n      /* Text */\n      ;\n      this._sectionStart = this._index + 1;\n    } else if (!whitespace(c)) {\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._stateInAttributeName = function (c) {\n    if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n      this._cbs.onattribname(this._getSection());\n\n      this._sectionStart = -1;\n      this._state = 10\n      /* AfterAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._stateAfterAttributeName = function (c) {\n    if (c === \"=\") {\n      this._state = 11\n      /* BeforeAttributeValue */\n      ;\n    } else if (c === \"/\" || c === \">\") {\n      this._cbs.onattribend();\n\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    } else if (!whitespace(c)) {\n      this._cbs.onattribend();\n\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateBeforeAttributeValue = function (c) {\n    if (c === '\"') {\n      this._state = 12\n      /* InAttributeValueDq */\n      ;\n      this._sectionStart = this._index + 1;\n    } else if (c === \"'\") {\n      this._state = 13\n      /* InAttributeValueSq */\n      ;\n      this._sectionStart = this._index + 1;\n    } else if (!whitespace(c)) {\n      this._state = 14\n      /* InAttributeValueNq */\n      ;\n      this._sectionStart = this._index;\n      this._index--; //reconsume token\n    }\n  };\n\n  Tokenizer.prototype._stateInAttributeValueDoubleQuotes = function (c) {\n    if (c === '\"') {\n      this._emitToken(\"onattribdata\");\n\n      this._cbs.onattribend();\n\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n    } else if (this._decodeEntities && c === \"&\") {\n      this._emitToken(\"onattribdata\");\n\n      this._baseState = this._state;\n      this._state = 51\n      /* BeforeEntity */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateInAttributeValueSingleQuotes = function (c) {\n    if (c === \"'\") {\n      this._emitToken(\"onattribdata\");\n\n      this._cbs.onattribend();\n\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n    } else if (this._decodeEntities && c === \"&\") {\n      this._emitToken(\"onattribdata\");\n\n      this._baseState = this._state;\n      this._state = 51\n      /* BeforeEntity */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateInAttributeValueNoQuotes = function (c) {\n    if (whitespace(c) || c === \">\") {\n      this._emitToken(\"onattribdata\");\n\n      this._cbs.onattribend();\n\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    } else if (this._decodeEntities && c === \"&\") {\n      this._emitToken(\"onattribdata\");\n\n      this._baseState = this._state;\n      this._state = 51\n      /* BeforeEntity */\n      ;\n      this._sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype._stateBeforeDeclaration = function (c) {\n    this._state = c === \"[\" ? 22\n    /* BeforeCdata1 */\n    : c === \"-\" ? 18\n    /* BeforeComment */\n    : 16\n    /* InDeclaration */\n    ;\n  };\n\n  Tokenizer.prototype._stateInDeclaration = function (c) {\n    if (c === \">\") {\n      this._cbs.ondeclaration(this._getSection());\n\n      this._state = 1\n      /* Text */\n      ;\n      this._sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype._stateInProcessingInstruction = function (c) {\n    if (c === \">\") {\n      this._cbs.onprocessinginstruction(this._getSection());\n\n      this._state = 1\n      /* Text */\n      ;\n      this._sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype._stateBeforeComment = function (c) {\n    if (c === \"-\") {\n      this._state = 19\n      /* InComment */\n      ;\n      this._sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n    }\n  };\n\n  Tokenizer.prototype._stateInComment = function (c) {\n    if (c === \"-\") this._state = 20\n    /* AfterComment1 */\n    ;\n  };\n\n  Tokenizer.prototype._stateAfterComment1 = function (c) {\n    if (c === \"-\") {\n      this._state = 21\n      /* AfterComment2 */\n      ;\n    } else {\n      this._state = 19\n      /* InComment */\n      ;\n    }\n  };\n\n  Tokenizer.prototype._stateAfterComment2 = function (c) {\n    if (c === \">\") {\n      //remove 2 trailing chars\n      this._cbs.oncomment(this._buffer.substring(this._sectionStart, this._index - 2));\n\n      this._state = 1\n      /* Text */\n      ;\n      this._sectionStart = this._index + 1;\n    } else if (c !== \"-\") {\n      this._state = 19\n      /* InComment */\n      ;\n    } // else: stay in AFTER_COMMENT_2 (`--->`)\n\n  };\n\n  Tokenizer.prototype._stateBeforeCdata6 = function (c) {\n    if (c === \"[\") {\n      this._state = 28\n      /* InCdata */\n      ;\n      this._sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._stateInCdata = function (c) {\n    if (c === \"]\") this._state = 29\n    /* AfterCdata1 */\n    ;\n  };\n\n  Tokenizer.prototype._stateAfterCdata1 = function (c) {\n    if (c === \"]\") this._state = 30\n    /* AfterCdata2 */\n    ;else this._state = 28\n    /* InCdata */\n    ;\n  };\n\n  Tokenizer.prototype._stateAfterCdata2 = function (c) {\n    if (c === \">\") {\n      //remove 2 trailing chars\n      this._cbs.oncdata(this._buffer.substring(this._sectionStart, this._index - 2));\n\n      this._state = 1\n      /* Text */\n      ;\n      this._sectionStart = this._index + 1;\n    } else if (c !== \"]\") {\n      this._state = 28\n      /* InCdata */\n      ;\n    } //else: stay in AFTER_CDATA_2 (`]]]>`)\n\n  };\n\n  Tokenizer.prototype._stateBeforeSpecial = function (c) {\n    if (c === \"c\" || c === \"C\") {\n      this._state = 33\n      /* BeforeScript1 */\n      ;\n    } else if (c === \"t\" || c === \"T\") {\n      this._state = 43\n      /* BeforeStyle1 */\n      ;\n    } else {\n      this._state = 3\n      /* InTagName */\n      ;\n      this._index--; //consume the token again\n    }\n  };\n\n  Tokenizer.prototype._stateBeforeSpecialEnd = function (c) {\n    if (this._special === 2\n    /* Script */\n    && (c === \"c\" || c === \"C\")) {\n      this._state = 38\n      /* AfterScript1 */\n      ;\n    } else if (this._special === 3\n    /* Style */\n    && (c === \"t\" || c === \"T\")) {\n      this._state = 47\n      /* AfterStyle1 */\n      ;\n    } else this._state = 1\n    /* Text */\n    ;\n  };\n\n  Tokenizer.prototype._stateBeforeScript5 = function (c) {\n    if (c === \"/\" || c === \">\" || whitespace(c)) {\n      this._special = 2\n      /* Script */\n      ;\n    }\n\n    this._state = 3\n    /* InTagName */\n    ;\n    this._index--; //consume the token again\n  };\n\n  Tokenizer.prototype._stateAfterScript5 = function (c) {\n    if (c === \">\" || whitespace(c)) {\n      this._special = 1\n      /* None */\n      ;\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this._sectionStart = this._index - 6;\n      this._index--; //reconsume the token\n    } else this._state = 1\n    /* Text */\n    ;\n  };\n\n  Tokenizer.prototype._stateBeforeStyle4 = function (c) {\n    if (c === \"/\" || c === \">\" || whitespace(c)) {\n      this._special = 3\n      /* Style */\n      ;\n    }\n\n    this._state = 3\n    /* InTagName */\n    ;\n    this._index--; //consume the token again\n  };\n\n  Tokenizer.prototype._stateAfterStyle4 = function (c) {\n    if (c === \">\" || whitespace(c)) {\n      this._special = 1\n      /* None */\n      ;\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this._sectionStart = this._index - 5;\n      this._index--; //reconsume the token\n    } else this._state = 1\n    /* Text */\n    ;\n  }; //for entities terminated with a semicolon\n\n\n  Tokenizer.prototype._parseNamedEntityStrict = function () {\n    //offset = 1\n    if (this._sectionStart + 1 < this._index) {\n      var entity = this._buffer.substring(this._sectionStart + 1, this._index),\n          map = this._xmlMode ? xml_json_1.default : entities_json_1.default;\n\n      if (Object.prototype.hasOwnProperty.call(map, entity)) {\n        // @ts-ignore\n        this._emitPartial(map[entity]);\n\n        this._sectionStart = this._index + 1;\n      }\n    }\n  }; //parses legacy entities (without trailing semicolon)\n\n\n  Tokenizer.prototype._parseLegacyEntity = function () {\n    var start = this._sectionStart + 1;\n    var limit = this._index - start;\n    if (limit > 6) limit = 6; // The max length of legacy entities is 6\n\n    while (limit >= 2) {\n      // The min length of legacy entities is 2\n      var entity = this._buffer.substr(start, limit);\n\n      if (Object.prototype.hasOwnProperty.call(legacy_json_1.default, entity)) {\n        // @ts-ignore\n        this._emitPartial(legacy_json_1.default[entity]);\n\n        this._sectionStart += limit + 1;\n        return;\n      } else {\n        limit--;\n      }\n    }\n  };\n\n  Tokenizer.prototype._stateInNamedEntity = function (c) {\n    if (c === \";\") {\n      this._parseNamedEntityStrict();\n\n      if (this._sectionStart + 1 < this._index && !this._xmlMode) {\n        this._parseLegacyEntity();\n      }\n\n      this._state = this._baseState;\n    } else if ((c < \"a\" || c > \"z\") && (c < \"A\" || c > \"Z\") && (c < \"0\" || c > \"9\")) {\n      if (this._xmlMode || this._sectionStart + 1 === this._index) {// ignore\n      } else if (this._baseState !== 1\n      /* Text */\n      ) {\n          if (c !== \"=\") {\n            this._parseNamedEntityStrict();\n          }\n        } else {\n        this._parseLegacyEntity();\n      }\n\n      this._state = this._baseState;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._decodeNumericEntity = function (offset, base) {\n    var sectionStart = this._sectionStart + offset;\n\n    if (sectionStart !== this._index) {\n      //parse entity\n      var entity = this._buffer.substring(sectionStart, this._index);\n\n      var parsed = parseInt(entity, base);\n\n      this._emitPartial(decode_codepoint_1.default(parsed));\n\n      this._sectionStart = this._index;\n    } else {\n      this._sectionStart--;\n    }\n\n    this._state = this._baseState;\n  };\n\n  Tokenizer.prototype._stateInNumericEntity = function (c) {\n    if (c === \";\") {\n      this._decodeNumericEntity(2, 10);\n\n      this._sectionStart++;\n    } else if (c < \"0\" || c > \"9\") {\n      if (!this._xmlMode) {\n        this._decodeNumericEntity(2, 10);\n      } else {\n        this._state = this._baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._stateInHexEntity = function (c) {\n    if (c === \";\") {\n      this._decodeNumericEntity(3, 16);\n\n      this._sectionStart++;\n    } else if ((c < \"a\" || c > \"f\") && (c < \"A\" || c > \"F\") && (c < \"0\" || c > \"9\")) {\n      if (!this._xmlMode) {\n        this._decodeNumericEntity(3, 16);\n      } else {\n        this._state = this._baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype._cleanup = function () {\n    if (this._sectionStart < 0) {\n      this._buffer = \"\";\n      this._bufferOffset += this._index;\n      this._index = 0;\n    } else if (this._running) {\n      if (this._state === 1\n      /* Text */\n      ) {\n          if (this._sectionStart !== this._index) {\n            this._cbs.ontext(this._buffer.substr(this._sectionStart));\n          }\n\n          this._buffer = \"\";\n          this._bufferOffset += this._index;\n          this._index = 0;\n        } else if (this._sectionStart === this._index) {\n        //the section just started\n        this._buffer = \"\";\n        this._bufferOffset += this._index;\n        this._index = 0;\n      } else {\n        //remove everything unnecessary\n        this._buffer = this._buffer.substr(this._sectionStart);\n        this._index -= this._sectionStart;\n        this._bufferOffset += this._sectionStart;\n      }\n\n      this._sectionStart = 0;\n    }\n  }; //TODO make events conditional\n\n\n  Tokenizer.prototype.write = function (chunk) {\n    if (this._ended) this._cbs.onerror(Error(\".write() after done!\"));\n    this._buffer += chunk;\n\n    this._parse();\n  }; // Iterates through the buffer, calling the function corresponding to the current state.\n  // States that are more likely to be hit are higher up, as a performance improvement.\n\n\n  Tokenizer.prototype._parse = function () {\n    while (this._index < this._buffer.length && this._running) {\n      var c = this._buffer.charAt(this._index);\n\n      if (this._state === 1\n      /* Text */\n      ) {\n          this._stateText(c);\n        } else if (this._state === 12\n      /* InAttributeValueDq */\n      ) {\n          this._stateInAttributeValueDoubleQuotes(c);\n        } else if (this._state === 9\n      /* InAttributeName */\n      ) {\n          this._stateInAttributeName(c);\n        } else if (this._state === 19\n      /* InComment */\n      ) {\n          this._stateInComment(c);\n        } else if (this._state === 8\n      /* BeforeAttributeName */\n      ) {\n          this._stateBeforeAttributeName(c);\n        } else if (this._state === 3\n      /* InTagName */\n      ) {\n          this._stateInTagName(c);\n        } else if (this._state === 6\n      /* InClosingTagName */\n      ) {\n          this._stateInClosingTagName(c);\n        } else if (this._state === 2\n      /* BeforeTagName */\n      ) {\n          this._stateBeforeTagName(c);\n        } else if (this._state === 10\n      /* AfterAttributeName */\n      ) {\n          this._stateAfterAttributeName(c);\n        } else if (this._state === 13\n      /* InAttributeValueSq */\n      ) {\n          this._stateInAttributeValueSingleQuotes(c);\n        } else if (this._state === 11\n      /* BeforeAttributeValue */\n      ) {\n          this._stateBeforeAttributeValue(c);\n        } else if (this._state === 5\n      /* BeforeClosingTagName */\n      ) {\n          this._stateBeforeClosingTagName(c);\n        } else if (this._state === 7\n      /* AfterClosingTagName */\n      ) {\n          this._stateAfterClosingTagName(c);\n        } else if (this._state === 31\n      /* BeforeSpecial */\n      ) {\n          this._stateBeforeSpecial(c);\n        } else if (this._state === 20\n      /* AfterComment1 */\n      ) {\n          this._stateAfterComment1(c);\n        } else if (this._state === 14\n      /* InAttributeValueNq */\n      ) {\n          this._stateInAttributeValueNoQuotes(c);\n        } else if (this._state === 4\n      /* InSelfClosingTag */\n      ) {\n          this._stateInSelfClosingTag(c);\n        } else if (this._state === 16\n      /* InDeclaration */\n      ) {\n          this._stateInDeclaration(c);\n        } else if (this._state === 15\n      /* BeforeDeclaration */\n      ) {\n          this._stateBeforeDeclaration(c);\n        } else if (this._state === 21\n      /* AfterComment2 */\n      ) {\n          this._stateAfterComment2(c);\n        } else if (this._state === 18\n      /* BeforeComment */\n      ) {\n          this._stateBeforeComment(c);\n        } else if (this._state === 32\n      /* BeforeSpecialEnd */\n      ) {\n          this._stateBeforeSpecialEnd(c);\n        } else if (this._state === 38\n      /* AfterScript1 */\n      ) {\n          stateAfterScript1(this, c);\n        } else if (this._state === 39\n      /* AfterScript2 */\n      ) {\n          stateAfterScript2(this, c);\n        } else if (this._state === 40\n      /* AfterScript3 */\n      ) {\n          stateAfterScript3(this, c);\n        } else if (this._state === 33\n      /* BeforeScript1 */\n      ) {\n          stateBeforeScript1(this, c);\n        } else if (this._state === 34\n      /* BeforeScript2 */\n      ) {\n          stateBeforeScript2(this, c);\n        } else if (this._state === 35\n      /* BeforeScript3 */\n      ) {\n          stateBeforeScript3(this, c);\n        } else if (this._state === 36\n      /* BeforeScript4 */\n      ) {\n          stateBeforeScript4(this, c);\n        } else if (this._state === 37\n      /* BeforeScript5 */\n      ) {\n          this._stateBeforeScript5(c);\n        } else if (this._state === 41\n      /* AfterScript4 */\n      ) {\n          stateAfterScript4(this, c);\n        } else if (this._state === 42\n      /* AfterScript5 */\n      ) {\n          this._stateAfterScript5(c);\n        } else if (this._state === 43\n      /* BeforeStyle1 */\n      ) {\n          stateBeforeStyle1(this, c);\n        } else if (this._state === 28\n      /* InCdata */\n      ) {\n          this._stateInCdata(c);\n        } else if (this._state === 44\n      /* BeforeStyle2 */\n      ) {\n          stateBeforeStyle2(this, c);\n        } else if (this._state === 45\n      /* BeforeStyle3 */\n      ) {\n          stateBeforeStyle3(this, c);\n        } else if (this._state === 46\n      /* BeforeStyle4 */\n      ) {\n          this._stateBeforeStyle4(c);\n        } else if (this._state === 47\n      /* AfterStyle1 */\n      ) {\n          stateAfterStyle1(this, c);\n        } else if (this._state === 48\n      /* AfterStyle2 */\n      ) {\n          stateAfterStyle2(this, c);\n        } else if (this._state === 49\n      /* AfterStyle3 */\n      ) {\n          stateAfterStyle3(this, c);\n        } else if (this._state === 50\n      /* AfterStyle4 */\n      ) {\n          this._stateAfterStyle4(c);\n        } else if (this._state === 17\n      /* InProcessingInstruction */\n      ) {\n          this._stateInProcessingInstruction(c);\n        } else if (this._state === 53\n      /* InNamedEntity */\n      ) {\n          this._stateInNamedEntity(c);\n        } else if (this._state === 22\n      /* BeforeCdata1 */\n      ) {\n          stateBeforeCdata1(this, c);\n        } else if (this._state === 51\n      /* BeforeEntity */\n      ) {\n          stateBeforeEntity(this, c);\n        } else if (this._state === 23\n      /* BeforeCdata2 */\n      ) {\n          stateBeforeCdata2(this, c);\n        } else if (this._state === 24\n      /* BeforeCdata3 */\n      ) {\n          stateBeforeCdata3(this, c);\n        } else if (this._state === 29\n      /* AfterCdata1 */\n      ) {\n          this._stateAfterCdata1(c);\n        } else if (this._state === 30\n      /* AfterCdata2 */\n      ) {\n          this._stateAfterCdata2(c);\n        } else if (this._state === 25\n      /* BeforeCdata4 */\n      ) {\n          stateBeforeCdata4(this, c);\n        } else if (this._state === 26\n      /* BeforeCdata5 */\n      ) {\n          stateBeforeCdata5(this, c);\n        } else if (this._state === 27\n      /* BeforeCdata6 */\n      ) {\n          this._stateBeforeCdata6(c);\n        } else if (this._state === 55\n      /* InHexEntity */\n      ) {\n          this._stateInHexEntity(c);\n        } else if (this._state === 54\n      /* InNumericEntity */\n      ) {\n          this._stateInNumericEntity(c);\n        } else if (this._state === 52\n      /* BeforeNumericEntity */\n      ) {\n          stateBeforeNumericEntity(this, c);\n        } else {\n        this._cbs.onerror(Error(\"unknown _state\"), this._state);\n      }\n\n      this._index++;\n    }\n\n    this._cleanup();\n  };\n\n  Tokenizer.prototype.pause = function () {\n    this._running = false;\n  };\n\n  Tokenizer.prototype.resume = function () {\n    this._running = true;\n\n    if (this._index < this._buffer.length) {\n      this._parse();\n    }\n\n    if (this._ended) {\n      this._finish();\n    }\n  };\n\n  Tokenizer.prototype.end = function (chunk) {\n    if (this._ended) this._cbs.onerror(Error(\".end() after done!\"));\n    if (chunk) this.write(chunk);\n    this._ended = true;\n    if (this._running) this._finish();\n  };\n\n  Tokenizer.prototype._finish = function () {\n    //if there is remaining data, emit it in a reasonable way\n    if (this._sectionStart < this._index) {\n      this._handleTrailingData();\n    }\n\n    this._cbs.onend();\n  };\n\n  Tokenizer.prototype._handleTrailingData = function () {\n    var data = this._buffer.substr(this._sectionStart);\n\n    if (this._state === 28\n    /* InCdata */\n    || this._state === 29\n    /* AfterCdata1 */\n    || this._state === 30\n    /* AfterCdata2 */\n    ) {\n        this._cbs.oncdata(data);\n      } else if (this._state === 19\n    /* InComment */\n    || this._state === 20\n    /* AfterComment1 */\n    || this._state === 21\n    /* AfterComment2 */\n    ) {\n        this._cbs.oncomment(data);\n      } else if (this._state === 53\n    /* InNamedEntity */\n    && !this._xmlMode) {\n      this._parseLegacyEntity();\n\n      if (this._sectionStart < this._index) {\n        this._state = this._baseState;\n\n        this._handleTrailingData();\n      }\n    } else if (this._state === 54\n    /* InNumericEntity */\n    && !this._xmlMode) {\n      this._decodeNumericEntity(2, 10);\n\n      if (this._sectionStart < this._index) {\n        this._state = this._baseState;\n\n        this._handleTrailingData();\n      }\n    } else if (this._state === 55\n    /* InHexEntity */\n    && !this._xmlMode) {\n      this._decodeNumericEntity(3, 16);\n\n      if (this._sectionStart < this._index) {\n        this._state = this._baseState;\n\n        this._handleTrailingData();\n      }\n    } else if (this._state !== 3\n    /* InTagName */\n    && this._state !== 8\n    /* BeforeAttributeName */\n    && this._state !== 11\n    /* BeforeAttributeValue */\n    && this._state !== 10\n    /* AfterAttributeName */\n    && this._state !== 9\n    /* InAttributeName */\n    && this._state !== 13\n    /* InAttributeValueSq */\n    && this._state !== 12\n    /* InAttributeValueDq */\n    && this._state !== 14\n    /* InAttributeValueNq */\n    && this._state !== 6\n    /* InClosingTagName */\n    ) {\n        this._cbs.ontext(data);\n      } //else, ignore remaining data\n    //TODO add a way to remove current tag\n\n  };\n\n  Tokenizer.prototype.getAbsoluteIndex = function () {\n    return this._bufferOffset + this._index;\n  };\n\n  Tokenizer.prototype._getSection = function () {\n    return this._buffer.substring(this._sectionStart, this._index);\n  };\n\n  Tokenizer.prototype._emitToken = function (name) {\n    this._cbs[name](this._getSection());\n\n    this._sectionStart = -1;\n  };\n\n  Tokenizer.prototype._emitPartial = function (value) {\n    if (this._baseState !== 1\n    /* Text */\n    ) {\n        this._cbs.onattribdata(value); //TODO implement the new event\n\n      } else {\n      this._cbs.ontext(value);\n    }\n  };\n\n  return Tokenizer;\n}();\n\nexports.default = Tokenizer;","map":{"version":3,"sources":["/home/chemime/Desktop/Python/django/trainingapp/frontend/node_modules/htmlparser2/lib/Tokenizer.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","decode_codepoint_1","require","entities_json_1","legacy_json_1","xml_json_1","whitespace","c","ifElseState","upper","SUCCESS","FAILURE","lower","toLowerCase","t","_state","_index","consumeSpecialNameChar","NEXT_STATE","stateBeforeCdata1","stateBeforeCdata2","stateBeforeCdata3","stateBeforeCdata4","stateBeforeCdata5","stateBeforeScript1","stateBeforeScript2","stateBeforeScript3","stateBeforeScript4","stateAfterScript1","stateAfterScript2","stateAfterScript3","stateAfterScript4","stateBeforeStyle1","stateBeforeStyle2","stateBeforeStyle3","stateAfterStyle1","stateAfterStyle2","stateAfterStyle3","stateBeforeEntity","stateBeforeNumericEntity","Tokenizer","options","cbs","_buffer","_sectionStart","_bufferOffset","_baseState","_special","_running","_ended","_cbs","_xmlMode","xmlMode","_decodeEntities","decodeEntities","prototype","reset","_stateText","ontext","_getSection","_stateBeforeTagName","_stateInTagName","_emitToken","_stateBeforeClosingTagName","_stateInClosingTagName","_stateAfterClosingTagName","_stateBeforeAttributeName","onopentagend","_stateInSelfClosingTag","onselfclosingtag","_stateInAttributeName","onattribname","_stateAfterAttributeName","onattribend","_stateBeforeAttributeValue","_stateInAttributeValueDoubleQuotes","_stateInAttributeValueSingleQuotes","_stateInAttributeValueNoQuotes","_stateBeforeDeclaration","_stateInDeclaration","ondeclaration","_stateInProcessingInstruction","onprocessinginstruction","_stateBeforeComment","_stateInComment","_stateAfterComment1","_stateAfterComment2","oncomment","substring","_stateBeforeCdata6","_stateInCdata","_stateAfterCdata1","_stateAfterCdata2","oncdata","_stateBeforeSpecial","_stateBeforeSpecialEnd","_stateBeforeScript5","_stateAfterScript5","_stateBeforeStyle4","_stateAfterStyle4","_parseNamedEntityStrict","entity","map","default","hasOwnProperty","call","_emitPartial","_parseLegacyEntity","start","limit","substr","_stateInNamedEntity","_decodeNumericEntity","offset","base","sectionStart","parsed","parseInt","_stateInNumericEntity","_stateInHexEntity","_cleanup","write","chunk","onerror","Error","_parse","length","charAt","pause","resume","_finish","end","_handleTrailingData","onend","data","getAbsoluteIndex","name","onattribdata"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\nvar entities_json_1 = __importDefault(require(\"entities/lib/maps/entities.json\"));\nvar legacy_json_1 = __importDefault(require(\"entities/lib/maps/legacy.json\"));\nvar xml_json_1 = __importDefault(require(\"entities/lib/maps/xml.json\"));\nfunction whitespace(c) {\n    return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n    var lower = upper.toLowerCase();\n    if (upper === lower) {\n        return function (t, c) {\n            if (c === lower) {\n                t._state = SUCCESS;\n            }\n            else {\n                t._state = FAILURE;\n                t._index--;\n            }\n        };\n    }\n    else {\n        return function (t, c) {\n            if (c === lower || c === upper) {\n                t._state = SUCCESS;\n            }\n            else {\n                t._state = FAILURE;\n                t._index--;\n            }\n        };\n    }\n}\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n    var lower = upper.toLowerCase();\n    return function (t, c) {\n        if (c === lower || c === upper) {\n            t._state = NEXT_STATE;\n        }\n        else {\n            t._state = 3 /* InTagName */;\n            t._index--; //consume the token again\n        }\n    };\n}\nvar stateBeforeCdata1 = ifElseState(\"C\", 23 /* BeforeCdata2 */, 16 /* InDeclaration */);\nvar stateBeforeCdata2 = ifElseState(\"D\", 24 /* BeforeCdata3 */, 16 /* InDeclaration */);\nvar stateBeforeCdata3 = ifElseState(\"A\", 25 /* BeforeCdata4 */, 16 /* InDeclaration */);\nvar stateBeforeCdata4 = ifElseState(\"T\", 26 /* BeforeCdata5 */, 16 /* InDeclaration */);\nvar stateBeforeCdata5 = ifElseState(\"A\", 27 /* BeforeCdata6 */, 16 /* InDeclaration */);\nvar stateBeforeScript1 = consumeSpecialNameChar(\"R\", 34 /* BeforeScript2 */);\nvar stateBeforeScript2 = consumeSpecialNameChar(\"I\", 35 /* BeforeScript3 */);\nvar stateBeforeScript3 = consumeSpecialNameChar(\"P\", 36 /* BeforeScript4 */);\nvar stateBeforeScript4 = consumeSpecialNameChar(\"T\", 37 /* BeforeScript5 */);\nvar stateAfterScript1 = ifElseState(\"R\", 39 /* AfterScript2 */, 1 /* Text */);\nvar stateAfterScript2 = ifElseState(\"I\", 40 /* AfterScript3 */, 1 /* Text */);\nvar stateAfterScript3 = ifElseState(\"P\", 41 /* AfterScript4 */, 1 /* Text */);\nvar stateAfterScript4 = ifElseState(\"T\", 42 /* AfterScript5 */, 1 /* Text */);\nvar stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", 44 /* BeforeStyle2 */);\nvar stateBeforeStyle2 = consumeSpecialNameChar(\"L\", 45 /* BeforeStyle3 */);\nvar stateBeforeStyle3 = consumeSpecialNameChar(\"E\", 46 /* BeforeStyle4 */);\nvar stateAfterStyle1 = ifElseState(\"Y\", 48 /* AfterStyle2 */, 1 /* Text */);\nvar stateAfterStyle2 = ifElseState(\"L\", 49 /* AfterStyle3 */, 1 /* Text */);\nvar stateAfterStyle3 = ifElseState(\"E\", 50 /* AfterStyle4 */, 1 /* Text */);\nvar stateBeforeEntity = ifElseState(\"#\", 52 /* BeforeNumericEntity */, 53 /* InNamedEntity */);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 55 /* InHexEntity */, 54 /* InNumericEntity */);\nvar Tokenizer = /** @class */ (function () {\n    function Tokenizer(options, cbs) {\n        /** The current state the tokenizer is in. */\n        this._state = 1 /* Text */;\n        /** The read buffer. */\n        this._buffer = \"\";\n        /** The beginning of the section that is currently being read. */\n        this._sectionStart = 0;\n        /** The index within the buffer that we are currently looking at. */\n        this._index = 0;\n        /**\n         * Data that has already been processed will be removed from the buffer occasionally.\n         * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n         */\n        this._bufferOffset = 0;\n        /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n        this._baseState = 1 /* Text */;\n        /** For special parsing behavior inside of script and style tags. */\n        this._special = 1 /* None */;\n        /** Indicates whether the tokenizer has been paused. */\n        this._running = true;\n        /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n        this._ended = false;\n        this._cbs = cbs;\n        this._xmlMode = !!(options && options.xmlMode);\n        this._decodeEntities = !!(options && options.decodeEntities);\n    }\n    Tokenizer.prototype.reset = function () {\n        this._state = 1 /* Text */;\n        this._buffer = \"\";\n        this._sectionStart = 0;\n        this._index = 0;\n        this._bufferOffset = 0;\n        this._baseState = 1 /* Text */;\n        this._special = 1 /* None */;\n        this._running = true;\n        this._ended = false;\n    };\n    Tokenizer.prototype._stateText = function (c) {\n        if (c === \"<\") {\n            if (this._index > this._sectionStart) {\n                this._cbs.ontext(this._getSection());\n            }\n            this._state = 2 /* BeforeTagName */;\n            this._sectionStart = this._index;\n        }\n        else if (this._decodeEntities &&\n            this._special === 1 /* None */ &&\n            c === \"&\") {\n            if (this._index > this._sectionStart) {\n                this._cbs.ontext(this._getSection());\n            }\n            this._baseState = 1 /* Text */;\n            this._state = 51 /* BeforeEntity */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateBeforeTagName = function (c) {\n        if (c === \"/\") {\n            this._state = 5 /* BeforeClosingTagName */;\n        }\n        else if (c === \"<\") {\n            this._cbs.ontext(this._getSection());\n            this._sectionStart = this._index;\n        }\n        else if (c === \">\" ||\n            this._special !== 1 /* None */ ||\n            whitespace(c)) {\n            this._state = 1 /* Text */;\n        }\n        else if (c === \"!\") {\n            this._state = 15 /* BeforeDeclaration */;\n            this._sectionStart = this._index + 1;\n        }\n        else if (c === \"?\") {\n            this._state = 17 /* InProcessingInstruction */;\n            this._sectionStart = this._index + 1;\n        }\n        else {\n            this._state =\n                !this._xmlMode && (c === \"s\" || c === \"S\")\n                    ? 31 /* BeforeSpecial */\n                    : 3 /* InTagName */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateInTagName = function (c) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this._emitToken(\"onopentagname\");\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._stateBeforeClosingTagName = function (c) {\n        if (whitespace(c)) {\n            // ignore\n        }\n        else if (c === \">\") {\n            this._state = 1 /* Text */;\n        }\n        else if (this._special !== 1 /* None */) {\n            if (c === \"s\" || c === \"S\") {\n                this._state = 32 /* BeforeSpecialEnd */;\n            }\n            else {\n                this._state = 1 /* Text */;\n                this._index--;\n            }\n        }\n        else {\n            this._state = 6 /* InClosingTagName */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateInClosingTagName = function (c) {\n        if (c === \">\" || whitespace(c)) {\n            this._emitToken(\"onclosetag\");\n            this._state = 7 /* AfterClosingTagName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._stateAfterClosingTagName = function (c) {\n        //skip everything until \">\"\n        if (c === \">\") {\n            this._state = 1 /* Text */;\n            this._sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype._stateBeforeAttributeName = function (c) {\n        if (c === \">\") {\n            this._cbs.onopentagend();\n            this._state = 1 /* Text */;\n            this._sectionStart = this._index + 1;\n        }\n        else if (c === \"/\") {\n            this._state = 4 /* InSelfClosingTag */;\n        }\n        else if (!whitespace(c)) {\n            this._state = 9 /* InAttributeName */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateInSelfClosingTag = function (c) {\n        if (c === \">\") {\n            this._cbs.onselfclosingtag();\n            this._state = 1 /* Text */;\n            this._sectionStart = this._index + 1;\n        }\n        else if (!whitespace(c)) {\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._stateInAttributeName = function (c) {\n        if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n            this._cbs.onattribname(this._getSection());\n            this._sectionStart = -1;\n            this._state = 10 /* AfterAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._stateAfterAttributeName = function (c) {\n        if (c === \"=\") {\n            this._state = 11 /* BeforeAttributeValue */;\n        }\n        else if (c === \"/\" || c === \">\") {\n            this._cbs.onattribend();\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (!whitespace(c)) {\n            this._cbs.onattribend();\n            this._state = 9 /* InAttributeName */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateBeforeAttributeValue = function (c) {\n        if (c === '\"') {\n            this._state = 12 /* InAttributeValueDq */;\n            this._sectionStart = this._index + 1;\n        }\n        else if (c === \"'\") {\n            this._state = 13 /* InAttributeValueSq */;\n            this._sectionStart = this._index + 1;\n        }\n        else if (!whitespace(c)) {\n            this._state = 14 /* InAttributeValueNq */;\n            this._sectionStart = this._index;\n            this._index--; //reconsume token\n        }\n    };\n    Tokenizer.prototype._stateInAttributeValueDoubleQuotes = function (c) {\n        if (c === '\"') {\n            this._emitToken(\"onattribdata\");\n            this._cbs.onattribend();\n            this._state = 8 /* BeforeAttributeName */;\n        }\n        else if (this._decodeEntities && c === \"&\") {\n            this._emitToken(\"onattribdata\");\n            this._baseState = this._state;\n            this._state = 51 /* BeforeEntity */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateInAttributeValueSingleQuotes = function (c) {\n        if (c === \"'\") {\n            this._emitToken(\"onattribdata\");\n            this._cbs.onattribend();\n            this._state = 8 /* BeforeAttributeName */;\n        }\n        else if (this._decodeEntities && c === \"&\") {\n            this._emitToken(\"onattribdata\");\n            this._baseState = this._state;\n            this._state = 51 /* BeforeEntity */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateInAttributeValueNoQuotes = function (c) {\n        if (whitespace(c) || c === \">\") {\n            this._emitToken(\"onattribdata\");\n            this._cbs.onattribend();\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (this._decodeEntities && c === \"&\") {\n            this._emitToken(\"onattribdata\");\n            this._baseState = this._state;\n            this._state = 51 /* BeforeEntity */;\n            this._sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype._stateBeforeDeclaration = function (c) {\n        this._state =\n            c === \"[\"\n                ? 22 /* BeforeCdata1 */\n                : c === \"-\"\n                    ? 18 /* BeforeComment */\n                    : 16 /* InDeclaration */;\n    };\n    Tokenizer.prototype._stateInDeclaration = function (c) {\n        if (c === \">\") {\n            this._cbs.ondeclaration(this._getSection());\n            this._state = 1 /* Text */;\n            this._sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype._stateInProcessingInstruction = function (c) {\n        if (c === \">\") {\n            this._cbs.onprocessinginstruction(this._getSection());\n            this._state = 1 /* Text */;\n            this._sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype._stateBeforeComment = function (c) {\n        if (c === \"-\") {\n            this._state = 19 /* InComment */;\n            this._sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n        }\n    };\n    Tokenizer.prototype._stateInComment = function (c) {\n        if (c === \"-\")\n            this._state = 20 /* AfterComment1 */;\n    };\n    Tokenizer.prototype._stateAfterComment1 = function (c) {\n        if (c === \"-\") {\n            this._state = 21 /* AfterComment2 */;\n        }\n        else {\n            this._state = 19 /* InComment */;\n        }\n    };\n    Tokenizer.prototype._stateAfterComment2 = function (c) {\n        if (c === \">\") {\n            //remove 2 trailing chars\n            this._cbs.oncomment(this._buffer.substring(this._sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this._sectionStart = this._index + 1;\n        }\n        else if (c !== \"-\") {\n            this._state = 19 /* InComment */;\n        }\n        // else: stay in AFTER_COMMENT_2 (`--->`)\n    };\n    Tokenizer.prototype._stateBeforeCdata6 = function (c) {\n        if (c === \"[\") {\n            this._state = 28 /* InCdata */;\n            this._sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._stateInCdata = function (c) {\n        if (c === \"]\")\n            this._state = 29 /* AfterCdata1 */;\n    };\n    Tokenizer.prototype._stateAfterCdata1 = function (c) {\n        if (c === \"]\")\n            this._state = 30 /* AfterCdata2 */;\n        else\n            this._state = 28 /* InCdata */;\n    };\n    Tokenizer.prototype._stateAfterCdata2 = function (c) {\n        if (c === \">\") {\n            //remove 2 trailing chars\n            this._cbs.oncdata(this._buffer.substring(this._sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this._sectionStart = this._index + 1;\n        }\n        else if (c !== \"]\") {\n            this._state = 28 /* InCdata */;\n        }\n        //else: stay in AFTER_CDATA_2 (`]]]>`)\n    };\n    Tokenizer.prototype._stateBeforeSpecial = function (c) {\n        if (c === \"c\" || c === \"C\") {\n            this._state = 33 /* BeforeScript1 */;\n        }\n        else if (c === \"t\" || c === \"T\") {\n            this._state = 43 /* BeforeStyle1 */;\n        }\n        else {\n            this._state = 3 /* InTagName */;\n            this._index--; //consume the token again\n        }\n    };\n    Tokenizer.prototype._stateBeforeSpecialEnd = function (c) {\n        if (this._special === 2 /* Script */ && (c === \"c\" || c === \"C\")) {\n            this._state = 38 /* AfterScript1 */;\n        }\n        else if (this._special === 3 /* Style */ &&\n            (c === \"t\" || c === \"T\")) {\n            this._state = 47 /* AfterStyle1 */;\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    Tokenizer.prototype._stateBeforeScript5 = function (c) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this._special = 2 /* Script */;\n        }\n        this._state = 3 /* InTagName */;\n        this._index--; //consume the token again\n    };\n    Tokenizer.prototype._stateAfterScript5 = function (c) {\n        if (c === \">\" || whitespace(c)) {\n            this._special = 1 /* None */;\n            this._state = 6 /* InClosingTagName */;\n            this._sectionStart = this._index - 6;\n            this._index--; //reconsume the token\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    Tokenizer.prototype._stateBeforeStyle4 = function (c) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this._special = 3 /* Style */;\n        }\n        this._state = 3 /* InTagName */;\n        this._index--; //consume the token again\n    };\n    Tokenizer.prototype._stateAfterStyle4 = function (c) {\n        if (c === \">\" || whitespace(c)) {\n            this._special = 1 /* None */;\n            this._state = 6 /* InClosingTagName */;\n            this._sectionStart = this._index - 5;\n            this._index--; //reconsume the token\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    //for entities terminated with a semicolon\n    Tokenizer.prototype._parseNamedEntityStrict = function () {\n        //offset = 1\n        if (this._sectionStart + 1 < this._index) {\n            var entity = this._buffer.substring(this._sectionStart + 1, this._index), map = this._xmlMode ? xml_json_1.default : entities_json_1.default;\n            if (Object.prototype.hasOwnProperty.call(map, entity)) {\n                // @ts-ignore\n                this._emitPartial(map[entity]);\n                this._sectionStart = this._index + 1;\n            }\n        }\n    };\n    //parses legacy entities (without trailing semicolon)\n    Tokenizer.prototype._parseLegacyEntity = function () {\n        var start = this._sectionStart + 1;\n        var limit = this._index - start;\n        if (limit > 6)\n            limit = 6; // The max length of legacy entities is 6\n        while (limit >= 2) {\n            // The min length of legacy entities is 2\n            var entity = this._buffer.substr(start, limit);\n            if (Object.prototype.hasOwnProperty.call(legacy_json_1.default, entity)) {\n                // @ts-ignore\n                this._emitPartial(legacy_json_1.default[entity]);\n                this._sectionStart += limit + 1;\n                return;\n            }\n            else {\n                limit--;\n            }\n        }\n    };\n    Tokenizer.prototype._stateInNamedEntity = function (c) {\n        if (c === \";\") {\n            this._parseNamedEntityStrict();\n            if (this._sectionStart + 1 < this._index && !this._xmlMode) {\n                this._parseLegacyEntity();\n            }\n            this._state = this._baseState;\n        }\n        else if ((c < \"a\" || c > \"z\") &&\n            (c < \"A\" || c > \"Z\") &&\n            (c < \"0\" || c > \"9\")) {\n            if (this._xmlMode || this._sectionStart + 1 === this._index) {\n                // ignore\n            }\n            else if (this._baseState !== 1 /* Text */) {\n                if (c !== \"=\") {\n                    this._parseNamedEntityStrict();\n                }\n            }\n            else {\n                this._parseLegacyEntity();\n            }\n            this._state = this._baseState;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._decodeNumericEntity = function (offset, base) {\n        var sectionStart = this._sectionStart + offset;\n        if (sectionStart !== this._index) {\n            //parse entity\n            var entity = this._buffer.substring(sectionStart, this._index);\n            var parsed = parseInt(entity, base);\n            this._emitPartial(decode_codepoint_1.default(parsed));\n            this._sectionStart = this._index;\n        }\n        else {\n            this._sectionStart--;\n        }\n        this._state = this._baseState;\n    };\n    Tokenizer.prototype._stateInNumericEntity = function (c) {\n        if (c === \";\") {\n            this._decodeNumericEntity(2, 10);\n            this._sectionStart++;\n        }\n        else if (c < \"0\" || c > \"9\") {\n            if (!this._xmlMode) {\n                this._decodeNumericEntity(2, 10);\n            }\n            else {\n                this._state = this._baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._stateInHexEntity = function (c) {\n        if (c === \";\") {\n            this._decodeNumericEntity(3, 16);\n            this._sectionStart++;\n        }\n        else if ((c < \"a\" || c > \"f\") &&\n            (c < \"A\" || c > \"F\") &&\n            (c < \"0\" || c > \"9\")) {\n            if (!this._xmlMode) {\n                this._decodeNumericEntity(3, 16);\n            }\n            else {\n                this._state = this._baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype._cleanup = function () {\n        if (this._sectionStart < 0) {\n            this._buffer = \"\";\n            this._bufferOffset += this._index;\n            this._index = 0;\n        }\n        else if (this._running) {\n            if (this._state === 1 /* Text */) {\n                if (this._sectionStart !== this._index) {\n                    this._cbs.ontext(this._buffer.substr(this._sectionStart));\n                }\n                this._buffer = \"\";\n                this._bufferOffset += this._index;\n                this._index = 0;\n            }\n            else if (this._sectionStart === this._index) {\n                //the section just started\n                this._buffer = \"\";\n                this._bufferOffset += this._index;\n                this._index = 0;\n            }\n            else {\n                //remove everything unnecessary\n                this._buffer = this._buffer.substr(this._sectionStart);\n                this._index -= this._sectionStart;\n                this._bufferOffset += this._sectionStart;\n            }\n            this._sectionStart = 0;\n        }\n    };\n    //TODO make events conditional\n    Tokenizer.prototype.write = function (chunk) {\n        if (this._ended)\n            this._cbs.onerror(Error(\".write() after done!\"));\n        this._buffer += chunk;\n        this._parse();\n    };\n    // Iterates through the buffer, calling the function corresponding to the current state.\n    // States that are more likely to be hit are higher up, as a performance improvement.\n    Tokenizer.prototype._parse = function () {\n        while (this._index < this._buffer.length && this._running) {\n            var c = this._buffer.charAt(this._index);\n            if (this._state === 1 /* Text */) {\n                this._stateText(c);\n            }\n            else if (this._state === 12 /* InAttributeValueDq */) {\n                this._stateInAttributeValueDoubleQuotes(c);\n            }\n            else if (this._state === 9 /* InAttributeName */) {\n                this._stateInAttributeName(c);\n            }\n            else if (this._state === 19 /* InComment */) {\n                this._stateInComment(c);\n            }\n            else if (this._state === 8 /* BeforeAttributeName */) {\n                this._stateBeforeAttributeName(c);\n            }\n            else if (this._state === 3 /* InTagName */) {\n                this._stateInTagName(c);\n            }\n            else if (this._state === 6 /* InClosingTagName */) {\n                this._stateInClosingTagName(c);\n            }\n            else if (this._state === 2 /* BeforeTagName */) {\n                this._stateBeforeTagName(c);\n            }\n            else if (this._state === 10 /* AfterAttributeName */) {\n                this._stateAfterAttributeName(c);\n            }\n            else if (this._state === 13 /* InAttributeValueSq */) {\n                this._stateInAttributeValueSingleQuotes(c);\n            }\n            else if (this._state === 11 /* BeforeAttributeValue */) {\n                this._stateBeforeAttributeValue(c);\n            }\n            else if (this._state === 5 /* BeforeClosingTagName */) {\n                this._stateBeforeClosingTagName(c);\n            }\n            else if (this._state === 7 /* AfterClosingTagName */) {\n                this._stateAfterClosingTagName(c);\n            }\n            else if (this._state === 31 /* BeforeSpecial */) {\n                this._stateBeforeSpecial(c);\n            }\n            else if (this._state === 20 /* AfterComment1 */) {\n                this._stateAfterComment1(c);\n            }\n            else if (this._state === 14 /* InAttributeValueNq */) {\n                this._stateInAttributeValueNoQuotes(c);\n            }\n            else if (this._state === 4 /* InSelfClosingTag */) {\n                this._stateInSelfClosingTag(c);\n            }\n            else if (this._state === 16 /* InDeclaration */) {\n                this._stateInDeclaration(c);\n            }\n            else if (this._state === 15 /* BeforeDeclaration */) {\n                this._stateBeforeDeclaration(c);\n            }\n            else if (this._state === 21 /* AfterComment2 */) {\n                this._stateAfterComment2(c);\n            }\n            else if (this._state === 18 /* BeforeComment */) {\n                this._stateBeforeComment(c);\n            }\n            else if (this._state === 32 /* BeforeSpecialEnd */) {\n                this._stateBeforeSpecialEnd(c);\n            }\n            else if (this._state === 38 /* AfterScript1 */) {\n                stateAfterScript1(this, c);\n            }\n            else if (this._state === 39 /* AfterScript2 */) {\n                stateAfterScript2(this, c);\n            }\n            else if (this._state === 40 /* AfterScript3 */) {\n                stateAfterScript3(this, c);\n            }\n            else if (this._state === 33 /* BeforeScript1 */) {\n                stateBeforeScript1(this, c);\n            }\n            else if (this._state === 34 /* BeforeScript2 */) {\n                stateBeforeScript2(this, c);\n            }\n            else if (this._state === 35 /* BeforeScript3 */) {\n                stateBeforeScript3(this, c);\n            }\n            else if (this._state === 36 /* BeforeScript4 */) {\n                stateBeforeScript4(this, c);\n            }\n            else if (this._state === 37 /* BeforeScript5 */) {\n                this._stateBeforeScript5(c);\n            }\n            else if (this._state === 41 /* AfterScript4 */) {\n                stateAfterScript4(this, c);\n            }\n            else if (this._state === 42 /* AfterScript5 */) {\n                this._stateAfterScript5(c);\n            }\n            else if (this._state === 43 /* BeforeStyle1 */) {\n                stateBeforeStyle1(this, c);\n            }\n            else if (this._state === 28 /* InCdata */) {\n                this._stateInCdata(c);\n            }\n            else if (this._state === 44 /* BeforeStyle2 */) {\n                stateBeforeStyle2(this, c);\n            }\n            else if (this._state === 45 /* BeforeStyle3 */) {\n                stateBeforeStyle3(this, c);\n            }\n            else if (this._state === 46 /* BeforeStyle4 */) {\n                this._stateBeforeStyle4(c);\n            }\n            else if (this._state === 47 /* AfterStyle1 */) {\n                stateAfterStyle1(this, c);\n            }\n            else if (this._state === 48 /* AfterStyle2 */) {\n                stateAfterStyle2(this, c);\n            }\n            else if (this._state === 49 /* AfterStyle3 */) {\n                stateAfterStyle3(this, c);\n            }\n            else if (this._state === 50 /* AfterStyle4 */) {\n                this._stateAfterStyle4(c);\n            }\n            else if (this._state === 17 /* InProcessingInstruction */) {\n                this._stateInProcessingInstruction(c);\n            }\n            else if (this._state === 53 /* InNamedEntity */) {\n                this._stateInNamedEntity(c);\n            }\n            else if (this._state === 22 /* BeforeCdata1 */) {\n                stateBeforeCdata1(this, c);\n            }\n            else if (this._state === 51 /* BeforeEntity */) {\n                stateBeforeEntity(this, c);\n            }\n            else if (this._state === 23 /* BeforeCdata2 */) {\n                stateBeforeCdata2(this, c);\n            }\n            else if (this._state === 24 /* BeforeCdata3 */) {\n                stateBeforeCdata3(this, c);\n            }\n            else if (this._state === 29 /* AfterCdata1 */) {\n                this._stateAfterCdata1(c);\n            }\n            else if (this._state === 30 /* AfterCdata2 */) {\n                this._stateAfterCdata2(c);\n            }\n            else if (this._state === 25 /* BeforeCdata4 */) {\n                stateBeforeCdata4(this, c);\n            }\n            else if (this._state === 26 /* BeforeCdata5 */) {\n                stateBeforeCdata5(this, c);\n            }\n            else if (this._state === 27 /* BeforeCdata6 */) {\n                this._stateBeforeCdata6(c);\n            }\n            else if (this._state === 55 /* InHexEntity */) {\n                this._stateInHexEntity(c);\n            }\n            else if (this._state === 54 /* InNumericEntity */) {\n                this._stateInNumericEntity(c);\n            }\n            else if (this._state === 52 /* BeforeNumericEntity */) {\n                stateBeforeNumericEntity(this, c);\n            }\n            else {\n                this._cbs.onerror(Error(\"unknown _state\"), this._state);\n            }\n            this._index++;\n        }\n        this._cleanup();\n    };\n    Tokenizer.prototype.pause = function () {\n        this._running = false;\n    };\n    Tokenizer.prototype.resume = function () {\n        this._running = true;\n        if (this._index < this._buffer.length) {\n            this._parse();\n        }\n        if (this._ended) {\n            this._finish();\n        }\n    };\n    Tokenizer.prototype.end = function (chunk) {\n        if (this._ended)\n            this._cbs.onerror(Error(\".end() after done!\"));\n        if (chunk)\n            this.write(chunk);\n        this._ended = true;\n        if (this._running)\n            this._finish();\n    };\n    Tokenizer.prototype._finish = function () {\n        //if there is remaining data, emit it in a reasonable way\n        if (this._sectionStart < this._index) {\n            this._handleTrailingData();\n        }\n        this._cbs.onend();\n    };\n    Tokenizer.prototype._handleTrailingData = function () {\n        var data = this._buffer.substr(this._sectionStart);\n        if (this._state === 28 /* InCdata */ ||\n            this._state === 29 /* AfterCdata1 */ ||\n            this._state === 30 /* AfterCdata2 */) {\n            this._cbs.oncdata(data);\n        }\n        else if (this._state === 19 /* InComment */ ||\n            this._state === 20 /* AfterComment1 */ ||\n            this._state === 21 /* AfterComment2 */) {\n            this._cbs.oncomment(data);\n        }\n        else if (this._state === 53 /* InNamedEntity */ && !this._xmlMode) {\n            this._parseLegacyEntity();\n            if (this._sectionStart < this._index) {\n                this._state = this._baseState;\n                this._handleTrailingData();\n            }\n        }\n        else if (this._state === 54 /* InNumericEntity */ && !this._xmlMode) {\n            this._decodeNumericEntity(2, 10);\n            if (this._sectionStart < this._index) {\n                this._state = this._baseState;\n                this._handleTrailingData();\n            }\n        }\n        else if (this._state === 55 /* InHexEntity */ && !this._xmlMode) {\n            this._decodeNumericEntity(3, 16);\n            if (this._sectionStart < this._index) {\n                this._state = this._baseState;\n                this._handleTrailingData();\n            }\n        }\n        else if (this._state !== 3 /* InTagName */ &&\n            this._state !== 8 /* BeforeAttributeName */ &&\n            this._state !== 11 /* BeforeAttributeValue */ &&\n            this._state !== 10 /* AfterAttributeName */ &&\n            this._state !== 9 /* InAttributeName */ &&\n            this._state !== 13 /* InAttributeValueSq */ &&\n            this._state !== 12 /* InAttributeValueDq */ &&\n            this._state !== 14 /* InAttributeValueNq */ &&\n            this._state !== 6 /* InClosingTagName */) {\n            this._cbs.ontext(data);\n        }\n        //else, ignore remaining data\n        //TODO add a way to remove current tag\n    };\n    Tokenizer.prototype.getAbsoluteIndex = function () {\n        return this._bufferOffset + this._index;\n    };\n    Tokenizer.prototype._getSection = function () {\n        return this._buffer.substring(this._sectionStart, this._index);\n    };\n    Tokenizer.prototype._emitToken = function (name) {\n        this._cbs[name](this._getSection());\n        this._sectionStart = -1;\n    };\n    Tokenizer.prototype._emitPartial = function (value) {\n        if (this._baseState !== 1 /* Text */) {\n            this._cbs.onattribdata(value); //TODO implement the new event\n        }\n        else {\n            this._cbs.ontext(value);\n        }\n    };\n    return Tokenizer;\n}());\nexports.default = Tokenizer;\n"]},"metadata":{},"sourceType":"script"}