{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Tokenizer_1 = __importDefault(require(\"./Tokenizer\"));\n\nvar events_1 = require(\"events\");\n\nvar formTags = new Set([\"input\", \"option\", \"optgroup\", \"select\", \"button\", \"datalist\", \"textarea\"]);\nvar pTag = new Set([\"p\"]);\nvar openImpliesClose = {\n  tr: new Set([\"tr\", \"th\", \"td\"]),\n  th: new Set([\"th\"]),\n  td: new Set([\"thead\", \"th\", \"td\"]),\n  body: new Set([\"head\", \"link\", \"script\"]),\n  li: new Set([\"li\"]),\n  p: pTag,\n  h1: pTag,\n  h2: pTag,\n  h3: pTag,\n  h4: pTag,\n  h5: pTag,\n  h6: pTag,\n  select: formTags,\n  input: formTags,\n  output: formTags,\n  button: formTags,\n  datalist: formTags,\n  textarea: formTags,\n  option: new Set([\"option\"]),\n  optgroup: new Set([\"optgroup\", \"option\"]),\n  dd: new Set([\"dt\", \"dd\"]),\n  dt: new Set([\"dt\", \"dd\"]),\n  address: pTag,\n  article: pTag,\n  aside: pTag,\n  blockquote: pTag,\n  details: pTag,\n  div: pTag,\n  dl: pTag,\n  fieldset: pTag,\n  figcaption: pTag,\n  figure: pTag,\n  footer: pTag,\n  form: pTag,\n  header: pTag,\n  hr: pTag,\n  main: pTag,\n  nav: pTag,\n  ol: pTag,\n  pre: pTag,\n  section: pTag,\n  table: pTag,\n  ul: pTag,\n  rt: new Set([\"rt\", \"rp\"]),\n  rp: new Set([\"rt\", \"rp\"]),\n  tbody: new Set([\"thead\", \"tbody\"]),\n  tfoot: new Set([\"thead\", \"tbody\"])\n};\nvar voidElements = new Set([\"area\", \"base\", \"basefont\", \"br\", \"col\", \"command\", \"embed\", \"frame\", \"hr\", \"img\", \"input\", \"isindex\", \"keygen\", \"link\", \"meta\", \"param\", \"source\", \"track\", \"wbr\"]);\nvar foreignContextElements = new Set([\"math\", \"svg\"]);\nvar htmlIntegrationElements = new Set([\"mi\", \"mo\", \"mn\", \"ms\", \"mtext\", \"annotation-xml\", \"foreignObject\", \"desc\", \"title\"]);\nvar reNameEnd = /\\s|\\//;\n\nvar Parser =\n/** @class */\nfunction (_super) {\n  __extends(Parser, _super);\n\n  function Parser(cbs, options) {\n    var _this = _super.call(this) || this;\n\n    _this._tagname = \"\";\n    _this._attribname = \"\";\n    _this._attribvalue = \"\";\n    _this._attribs = null;\n    _this._stack = [];\n    _this._foreignContext = [];\n    _this.startIndex = 0;\n    _this.endIndex = null; // Aliases for backwards compatibility\n\n    _this.parseChunk = Parser.prototype.write;\n    _this.done = Parser.prototype.end;\n    _this._options = options || {};\n    _this._cbs = cbs || {};\n    _this._tagname = \"\";\n    _this._attribname = \"\";\n    _this._attribvalue = \"\";\n    _this._attribs = null;\n    _this._stack = [];\n    _this._foreignContext = [];\n    _this.startIndex = 0;\n    _this.endIndex = null;\n    _this._lowerCaseTagNames = \"lowerCaseTags\" in _this._options ? !!_this._options.lowerCaseTags : !_this._options.xmlMode;\n    _this._lowerCaseAttributeNames = \"lowerCaseAttributeNames\" in _this._options ? !!_this._options.lowerCaseAttributeNames : !_this._options.xmlMode;\n    _this._tokenizer = new (_this._options.Tokenizer || Tokenizer_1.default)(_this._options, _this);\n    if (_this._cbs.onparserinit) _this._cbs.onparserinit(_this);\n    return _this;\n  }\n\n  Parser.prototype._updatePosition = function (initialOffset) {\n    if (this.endIndex === null) {\n      if (this._tokenizer._sectionStart <= initialOffset) {\n        this.startIndex = 0;\n      } else {\n        this.startIndex = this._tokenizer._sectionStart - initialOffset;\n      }\n    } else this.startIndex = this.endIndex + 1;\n\n    this.endIndex = this._tokenizer.getAbsoluteIndex();\n  }; //Tokenizer event handlers\n\n\n  Parser.prototype.ontext = function (data) {\n    this._updatePosition(1); // @ts-ignore\n\n\n    this.endIndex--;\n    if (this._cbs.ontext) this._cbs.ontext(data);\n  };\n\n  Parser.prototype.onopentagname = function (name) {\n    if (this._lowerCaseTagNames) {\n      name = name.toLowerCase();\n    }\n\n    this._tagname = name;\n\n    if (!this._options.xmlMode && Object.prototype.hasOwnProperty.call(openImpliesClose, name)) {\n      for (var el = void 0; // @ts-ignore\n      openImpliesClose[name].has(el = this._stack[this._stack.length - 1]); this.onclosetag(el));\n    }\n\n    if (this._options.xmlMode || !voidElements.has(name)) {\n      this._stack.push(name);\n\n      if (foreignContextElements.has(name)) {\n        this._foreignContext.push(true);\n      } else if (htmlIntegrationElements.has(name)) {\n        this._foreignContext.push(false);\n      }\n    }\n\n    if (this._cbs.onopentagname) this._cbs.onopentagname(name);\n    if (this._cbs.onopentag) this._attribs = {};\n  };\n\n  Parser.prototype.onopentagend = function () {\n    this._updatePosition(1);\n\n    if (this._attribs) {\n      if (this._cbs.onopentag) {\n        this._cbs.onopentag(this._tagname, this._attribs);\n      }\n\n      this._attribs = null;\n    }\n\n    if (!this._options.xmlMode && this._cbs.onclosetag && voidElements.has(this._tagname)) {\n      this._cbs.onclosetag(this._tagname);\n    }\n\n    this._tagname = \"\";\n  };\n\n  Parser.prototype.onclosetag = function (name) {\n    this._updatePosition(1);\n\n    if (this._lowerCaseTagNames) {\n      name = name.toLowerCase();\n    }\n\n    if (foreignContextElements.has(name) || htmlIntegrationElements.has(name)) {\n      this._foreignContext.pop();\n    }\n\n    if (this._stack.length && (this._options.xmlMode || !voidElements.has(name))) {\n      var pos = this._stack.lastIndexOf(name);\n\n      if (pos !== -1) {\n        if (this._cbs.onclosetag) {\n          pos = this._stack.length - pos; // @ts-ignore\n\n          while (pos--) this._cbs.onclosetag(this._stack.pop());\n        } else this._stack.length = pos;\n      } else if (name === \"p\" && !this._options.xmlMode) {\n        this.onopentagname(name);\n\n        this._closeCurrentTag();\n      }\n    } else if (!this._options.xmlMode && (name === \"br\" || name === \"p\")) {\n      this.onopentagname(name);\n\n      this._closeCurrentTag();\n    }\n  };\n\n  Parser.prototype.onselfclosingtag = function () {\n    if (this._options.xmlMode || this._options.recognizeSelfClosing || this._foreignContext[this._foreignContext.length - 1]) {\n      this._closeCurrentTag();\n    } else {\n      this.onopentagend();\n    }\n  };\n\n  Parser.prototype._closeCurrentTag = function () {\n    var name = this._tagname;\n    this.onopentagend(); //self-closing tags will be on the top of the stack\n    //(cheaper check than in onclosetag)\n\n    if (this._stack[this._stack.length - 1] === name) {\n      if (this._cbs.onclosetag) {\n        this._cbs.onclosetag(name);\n      }\n\n      this._stack.pop();\n    }\n  };\n\n  Parser.prototype.onattribname = function (name) {\n    if (this._lowerCaseAttributeNames) {\n      name = name.toLowerCase();\n    }\n\n    this._attribname = name;\n  };\n\n  Parser.prototype.onattribdata = function (value) {\n    this._attribvalue += value;\n  };\n\n  Parser.prototype.onattribend = function () {\n    if (this._cbs.onattribute) this._cbs.onattribute(this._attribname, this._attribvalue);\n\n    if (this._attribs && !Object.prototype.hasOwnProperty.call(this._attribs, this._attribname)) {\n      this._attribs[this._attribname] = this._attribvalue;\n    }\n\n    this._attribname = \"\";\n    this._attribvalue = \"\";\n  };\n\n  Parser.prototype._getInstructionName = function (value) {\n    var idx = value.search(reNameEnd);\n    var name = idx < 0 ? value : value.substr(0, idx);\n\n    if (this._lowerCaseTagNames) {\n      name = name.toLowerCase();\n    }\n\n    return name;\n  };\n\n  Parser.prototype.ondeclaration = function (value) {\n    if (this._cbs.onprocessinginstruction) {\n      var name_1 = this._getInstructionName(value);\n\n      this._cbs.onprocessinginstruction(\"!\" + name_1, \"!\" + value);\n    }\n  };\n\n  Parser.prototype.onprocessinginstruction = function (value) {\n    if (this._cbs.onprocessinginstruction) {\n      var name_2 = this._getInstructionName(value);\n\n      this._cbs.onprocessinginstruction(\"?\" + name_2, \"?\" + value);\n    }\n  };\n\n  Parser.prototype.oncomment = function (value) {\n    this._updatePosition(4);\n\n    if (this._cbs.oncomment) this._cbs.oncomment(value);\n    if (this._cbs.oncommentend) this._cbs.oncommentend();\n  };\n\n  Parser.prototype.oncdata = function (value) {\n    this._updatePosition(1);\n\n    if (this._options.xmlMode || this._options.recognizeCDATA) {\n      if (this._cbs.oncdatastart) this._cbs.oncdatastart();\n      if (this._cbs.ontext) this._cbs.ontext(value);\n      if (this._cbs.oncdataend) this._cbs.oncdataend();\n    } else {\n      this.oncomment(\"[CDATA[\" + value + \"]]\");\n    }\n  };\n\n  Parser.prototype.onerror = function (err) {\n    if (this._cbs.onerror) this._cbs.onerror(err);\n  };\n\n  Parser.prototype.onend = function () {\n    if (this._cbs.onclosetag) {\n      for (var i = this._stack.length; i > 0; this._cbs.onclosetag(this._stack[--i]));\n    }\n\n    if (this._cbs.onend) this._cbs.onend();\n  }; //Resets the parser to a blank state, ready to parse a new HTML document\n\n\n  Parser.prototype.reset = function () {\n    if (this._cbs.onreset) this._cbs.onreset();\n\n    this._tokenizer.reset();\n\n    this._tagname = \"\";\n    this._attribname = \"\";\n    this._attribs = null;\n    this._stack = [];\n    if (this._cbs.onparserinit) this._cbs.onparserinit(this);\n  }; //Parses a complete HTML document and pushes it to the handler\n\n\n  Parser.prototype.parseComplete = function (data) {\n    this.reset();\n    this.end(data);\n  };\n\n  Parser.prototype.write = function (chunk) {\n    this._tokenizer.write(chunk);\n  };\n\n  Parser.prototype.end = function (chunk) {\n    this._tokenizer.end(chunk);\n  };\n\n  Parser.prototype.pause = function () {\n    this._tokenizer.pause();\n  };\n\n  Parser.prototype.resume = function () {\n    this._tokenizer.resume();\n  };\n\n  return Parser;\n}(events_1.EventEmitter);\n\nexports.Parser = Parser;","map":{"version":3,"sources":["/home/chemime/Desktop/Python/django/trainingapp/frontend/node_modules/htmlparser2/lib/Parser.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__importDefault","mod","__esModule","defineProperty","exports","value","Tokenizer_1","require","events_1","formTags","Set","pTag","openImpliesClose","tr","th","td","body","li","h1","h2","h3","h4","h5","h6","select","input","output","button","datalist","textarea","option","optgroup","dd","dt","address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","header","hr","main","nav","ol","pre","section","table","ul","rt","rp","tbody","tfoot","voidElements","foreignContextElements","htmlIntegrationElements","reNameEnd","Parser","_super","cbs","options","_this","call","_tagname","_attribname","_attribvalue","_attribs","_stack","_foreignContext","startIndex","endIndex","parseChunk","write","done","end","_options","_cbs","_lowerCaseTagNames","lowerCaseTags","xmlMode","_lowerCaseAttributeNames","lowerCaseAttributeNames","_tokenizer","Tokenizer","default","onparserinit","_updatePosition","initialOffset","_sectionStart","getAbsoluteIndex","ontext","data","onopentagname","name","toLowerCase","el","has","length","onclosetag","push","onopentag","onopentagend","pop","pos","lastIndexOf","_closeCurrentTag","onselfclosingtag","recognizeSelfClosing","onattribname","onattribdata","onattribend","onattribute","_getInstructionName","idx","search","substr","ondeclaration","onprocessinginstruction","name_1","name_2","oncomment","oncommentend","oncdata","recognizeCDATA","oncdatastart","oncdataend","onerror","err","onend","i","reset","onreset","parseComplete","chunk","pause","resume","EventEmitter"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Tokenizer_1 = __importDefault(require(\"./Tokenizer\"));\nvar events_1 = require(\"events\");\nvar formTags = new Set([\n    \"input\",\n    \"option\",\n    \"optgroup\",\n    \"select\",\n    \"button\",\n    \"datalist\",\n    \"textarea\"\n]);\nvar pTag = new Set([\"p\"]);\nvar openImpliesClose = {\n    tr: new Set([\"tr\", \"th\", \"td\"]),\n    th: new Set([\"th\"]),\n    td: new Set([\"thead\", \"th\", \"td\"]),\n    body: new Set([\"head\", \"link\", \"script\"]),\n    li: new Set([\"li\"]),\n    p: pTag,\n    h1: pTag,\n    h2: pTag,\n    h3: pTag,\n    h4: pTag,\n    h5: pTag,\n    h6: pTag,\n    select: formTags,\n    input: formTags,\n    output: formTags,\n    button: formTags,\n    datalist: formTags,\n    textarea: formTags,\n    option: new Set([\"option\"]),\n    optgroup: new Set([\"optgroup\", \"option\"]),\n    dd: new Set([\"dt\", \"dd\"]),\n    dt: new Set([\"dt\", \"dd\"]),\n    address: pTag,\n    article: pTag,\n    aside: pTag,\n    blockquote: pTag,\n    details: pTag,\n    div: pTag,\n    dl: pTag,\n    fieldset: pTag,\n    figcaption: pTag,\n    figure: pTag,\n    footer: pTag,\n    form: pTag,\n    header: pTag,\n    hr: pTag,\n    main: pTag,\n    nav: pTag,\n    ol: pTag,\n    pre: pTag,\n    section: pTag,\n    table: pTag,\n    ul: pTag,\n    rt: new Set([\"rt\", \"rp\"]),\n    rp: new Set([\"rt\", \"rp\"]),\n    tbody: new Set([\"thead\", \"tbody\"]),\n    tfoot: new Set([\"thead\", \"tbody\"])\n};\nvar voidElements = new Set([\n    \"area\",\n    \"base\",\n    \"basefont\",\n    \"br\",\n    \"col\",\n    \"command\",\n    \"embed\",\n    \"frame\",\n    \"hr\",\n    \"img\",\n    \"input\",\n    \"isindex\",\n    \"keygen\",\n    \"link\",\n    \"meta\",\n    \"param\",\n    \"source\",\n    \"track\",\n    \"wbr\"\n]);\nvar foreignContextElements = new Set([\"math\", \"svg\"]);\nvar htmlIntegrationElements = new Set([\n    \"mi\",\n    \"mo\",\n    \"mn\",\n    \"ms\",\n    \"mtext\",\n    \"annotation-xml\",\n    \"foreignObject\",\n    \"desc\",\n    \"title\"\n]);\nvar reNameEnd = /\\s|\\//;\nvar Parser = /** @class */ (function (_super) {\n    __extends(Parser, _super);\n    function Parser(cbs, options) {\n        var _this = _super.call(this) || this;\n        _this._tagname = \"\";\n        _this._attribname = \"\";\n        _this._attribvalue = \"\";\n        _this._attribs = null;\n        _this._stack = [];\n        _this._foreignContext = [];\n        _this.startIndex = 0;\n        _this.endIndex = null;\n        // Aliases for backwards compatibility\n        _this.parseChunk = Parser.prototype.write;\n        _this.done = Parser.prototype.end;\n        _this._options = options || {};\n        _this._cbs = cbs || {};\n        _this._tagname = \"\";\n        _this._attribname = \"\";\n        _this._attribvalue = \"\";\n        _this._attribs = null;\n        _this._stack = [];\n        _this._foreignContext = [];\n        _this.startIndex = 0;\n        _this.endIndex = null;\n        _this._lowerCaseTagNames =\n            \"lowerCaseTags\" in _this._options\n                ? !!_this._options.lowerCaseTags\n                : !_this._options.xmlMode;\n        _this._lowerCaseAttributeNames =\n            \"lowerCaseAttributeNames\" in _this._options\n                ? !!_this._options.lowerCaseAttributeNames\n                : !_this._options.xmlMode;\n        _this._tokenizer = new (_this._options.Tokenizer || Tokenizer_1.default)(_this._options, _this);\n        if (_this._cbs.onparserinit)\n            _this._cbs.onparserinit(_this);\n        return _this;\n    }\n    Parser.prototype._updatePosition = function (initialOffset) {\n        if (this.endIndex === null) {\n            if (this._tokenizer._sectionStart <= initialOffset) {\n                this.startIndex = 0;\n            }\n            else {\n                this.startIndex = this._tokenizer._sectionStart - initialOffset;\n            }\n        }\n        else\n            this.startIndex = this.endIndex + 1;\n        this.endIndex = this._tokenizer.getAbsoluteIndex();\n    };\n    //Tokenizer event handlers\n    Parser.prototype.ontext = function (data) {\n        this._updatePosition(1);\n        // @ts-ignore\n        this.endIndex--;\n        if (this._cbs.ontext)\n            this._cbs.ontext(data);\n    };\n    Parser.prototype.onopentagname = function (name) {\n        if (this._lowerCaseTagNames) {\n            name = name.toLowerCase();\n        }\n        this._tagname = name;\n        if (!this._options.xmlMode &&\n            Object.prototype.hasOwnProperty.call(openImpliesClose, name)) {\n            for (var el = void 0; \n            // @ts-ignore\n            openImpliesClose[name].has((el = this._stack[this._stack.length - 1])); this.onclosetag(el))\n                ;\n        }\n        if (this._options.xmlMode || !voidElements.has(name)) {\n            this._stack.push(name);\n            if (foreignContextElements.has(name)) {\n                this._foreignContext.push(true);\n            }\n            else if (htmlIntegrationElements.has(name)) {\n                this._foreignContext.push(false);\n            }\n        }\n        if (this._cbs.onopentagname)\n            this._cbs.onopentagname(name);\n        if (this._cbs.onopentag)\n            this._attribs = {};\n    };\n    Parser.prototype.onopentagend = function () {\n        this._updatePosition(1);\n        if (this._attribs) {\n            if (this._cbs.onopentag) {\n                this._cbs.onopentag(this._tagname, this._attribs);\n            }\n            this._attribs = null;\n        }\n        if (!this._options.xmlMode &&\n            this._cbs.onclosetag &&\n            voidElements.has(this._tagname)) {\n            this._cbs.onclosetag(this._tagname);\n        }\n        this._tagname = \"\";\n    };\n    Parser.prototype.onclosetag = function (name) {\n        this._updatePosition(1);\n        if (this._lowerCaseTagNames) {\n            name = name.toLowerCase();\n        }\n        if (foreignContextElements.has(name) ||\n            htmlIntegrationElements.has(name)) {\n            this._foreignContext.pop();\n        }\n        if (this._stack.length &&\n            (this._options.xmlMode || !voidElements.has(name))) {\n            var pos = this._stack.lastIndexOf(name);\n            if (pos !== -1) {\n                if (this._cbs.onclosetag) {\n                    pos = this._stack.length - pos;\n                    // @ts-ignore\n                    while (pos--)\n                        this._cbs.onclosetag(this._stack.pop());\n                }\n                else\n                    this._stack.length = pos;\n            }\n            else if (name === \"p\" && !this._options.xmlMode) {\n                this.onopentagname(name);\n                this._closeCurrentTag();\n            }\n        }\n        else if (!this._options.xmlMode && (name === \"br\" || name === \"p\")) {\n            this.onopentagname(name);\n            this._closeCurrentTag();\n        }\n    };\n    Parser.prototype.onselfclosingtag = function () {\n        if (this._options.xmlMode ||\n            this._options.recognizeSelfClosing ||\n            this._foreignContext[this._foreignContext.length - 1]) {\n            this._closeCurrentTag();\n        }\n        else {\n            this.onopentagend();\n        }\n    };\n    Parser.prototype._closeCurrentTag = function () {\n        var name = this._tagname;\n        this.onopentagend();\n        //self-closing tags will be on the top of the stack\n        //(cheaper check than in onclosetag)\n        if (this._stack[this._stack.length - 1] === name) {\n            if (this._cbs.onclosetag) {\n                this._cbs.onclosetag(name);\n            }\n            this._stack.pop();\n        }\n    };\n    Parser.prototype.onattribname = function (name) {\n        if (this._lowerCaseAttributeNames) {\n            name = name.toLowerCase();\n        }\n        this._attribname = name;\n    };\n    Parser.prototype.onattribdata = function (value) {\n        this._attribvalue += value;\n    };\n    Parser.prototype.onattribend = function () {\n        if (this._cbs.onattribute)\n            this._cbs.onattribute(this._attribname, this._attribvalue);\n        if (this._attribs &&\n            !Object.prototype.hasOwnProperty.call(this._attribs, this._attribname)) {\n            this._attribs[this._attribname] = this._attribvalue;\n        }\n        this._attribname = \"\";\n        this._attribvalue = \"\";\n    };\n    Parser.prototype._getInstructionName = function (value) {\n        var idx = value.search(reNameEnd);\n        var name = idx < 0 ? value : value.substr(0, idx);\n        if (this._lowerCaseTagNames) {\n            name = name.toLowerCase();\n        }\n        return name;\n    };\n    Parser.prototype.ondeclaration = function (value) {\n        if (this._cbs.onprocessinginstruction) {\n            var name_1 = this._getInstructionName(value);\n            this._cbs.onprocessinginstruction(\"!\" + name_1, \"!\" + value);\n        }\n    };\n    Parser.prototype.onprocessinginstruction = function (value) {\n        if (this._cbs.onprocessinginstruction) {\n            var name_2 = this._getInstructionName(value);\n            this._cbs.onprocessinginstruction(\"?\" + name_2, \"?\" + value);\n        }\n    };\n    Parser.prototype.oncomment = function (value) {\n        this._updatePosition(4);\n        if (this._cbs.oncomment)\n            this._cbs.oncomment(value);\n        if (this._cbs.oncommentend)\n            this._cbs.oncommentend();\n    };\n    Parser.prototype.oncdata = function (value) {\n        this._updatePosition(1);\n        if (this._options.xmlMode || this._options.recognizeCDATA) {\n            if (this._cbs.oncdatastart)\n                this._cbs.oncdatastart();\n            if (this._cbs.ontext)\n                this._cbs.ontext(value);\n            if (this._cbs.oncdataend)\n                this._cbs.oncdataend();\n        }\n        else {\n            this.oncomment(\"[CDATA[\" + value + \"]]\");\n        }\n    };\n    Parser.prototype.onerror = function (err) {\n        if (this._cbs.onerror)\n            this._cbs.onerror(err);\n    };\n    Parser.prototype.onend = function () {\n        if (this._cbs.onclosetag) {\n            for (var i = this._stack.length; i > 0; this._cbs.onclosetag(this._stack[--i]))\n                ;\n        }\n        if (this._cbs.onend)\n            this._cbs.onend();\n    };\n    //Resets the parser to a blank state, ready to parse a new HTML document\n    Parser.prototype.reset = function () {\n        if (this._cbs.onreset)\n            this._cbs.onreset();\n        this._tokenizer.reset();\n        this._tagname = \"\";\n        this._attribname = \"\";\n        this._attribs = null;\n        this._stack = [];\n        if (this._cbs.onparserinit)\n            this._cbs.onparserinit(this);\n    };\n    //Parses a complete HTML document and pushes it to the handler\n    Parser.prototype.parseComplete = function (data) {\n        this.reset();\n        this.end(data);\n    };\n    Parser.prototype.write = function (chunk) {\n        this._tokenizer.write(chunk);\n    };\n    Parser.prototype.end = function (chunk) {\n        this._tokenizer.end(chunk);\n    };\n    Parser.prototype.pause = function () {\n        this._tokenizer.pause();\n    };\n    Parser.prototype.resume = function () {\n        this._tokenizer.resume();\n    };\n    return Parser;\n}(events_1.EventEmitter));\nexports.Parser = Parser;\n"]},"metadata":{},"sourceType":"script"}